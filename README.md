# Static Narrative Service
---
## Introduction

This service is used for creating and managing Static Narratives. These are Narratives that are meant to be available for public viewing. They are:

1. Viewable anonymously through a shareable link.
2. Non-functional, in that they cannot execute jobs or check on job status.
3. Non-updateable, each given version of a Static Narrative is tied to a specific version of the original working Narrative that was used to create it.
4. Partially interactive, while some elements (mainly the App Cells) have most of their interactivity in common with the Narrative Interface, other visualizer cells do not, and link back to their Narrative.

## Usage
---
...

## API
---
### Create Static Narrative
...

## Contributing
---
This is a [KBase](https://kbase.us) module generated by the [KBase Software Development Kit (SDK)](https://github.com/kbase/kb_sdk).

You will need to have the SDK installed to use this module. [Learn more about the SDK and how to use it](https://kbase.github.io/kb_sdk_docs/).

# Setup and test

Add your KBase developer token to `test_local/test.cfg` and run the following:

```bash
$ make
$ kb-sdk test
```

After making any additional changes to this repo, run `kb-sdk test` again to verify that everything still works.

# Deployment

This is deployed as all other KBase dynamic services, with a hitch. This needs an extra configured directory mount to put the generated static narratives. This is set internally to the module in `deploy.cfg` as `static-file-root`, but must be mounted in the running service externally.

As of 11/7/2019, we use Rancher to handle this process. The setup is done in the following steps.
1. Deploy the service (it might need to be prodded to start up a container, run `status` if needed).
2. Log in to Rancher on the environment to manage.
3. Scroll down to the `staticnarrative` entry and click the `+`
4. Figure out what's the active service, click on the link to it to go to the service page.
5. Click the `Upgrade` icon in the upper right corner.
6. Go to the `Volumes` tab, hit the `+ Add Volume` button, and put in this line: `/data/static_narratives:/kb/module/work/nginx`. Note that the second part of that is the entry for `static-file-root` in `deploy.cfg`.
7. Go over to the `Scheduling` tab, and add a rule: The host `must` have a `host label` of `kbasetype` = `core`, so it'll get deployed on the right node.
8. Hit the `Upgrade` button, and it should restart and be connected.

This will all become outdated (and removed) once the Service Wizard gets updated to do this as part of its service startup process. But right now it needs to be done by hand.


# Help

You may find the answers to your questions in our [FAQ](https://kbase.github.io/kb_sdk_docs/references/questions_and_answers.html) or [Troubleshooting Guide](https://kbase.github.io/kb_sdk_docs/references/troubleshooting.html).
